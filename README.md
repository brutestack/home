# Проект планировки дома — 2-й этаж и лестница

[![GitHub](https://img.shields.io/badge/GitHub-brutestack%2Fhome-blue)](https://github.com/brutestack/home)

## Описание

Интерактивная визуализация планировки второго этажа частного дома и проекта лестницы с первого на второй этаж. Проект включает:

- **План 2-го этажа** — SVG-схема с интерактивными координатами при наведении мыши
- **Каркас перегородки** — схема каркаса двойной перегородки спальни с раздвижной дверью + спецификация материалов (два варианта: ЛДСП и ГКЛ)
- **Детали лестницы** — три вида (сверху, сбоку, разрез/развёртка) с интерактивными курсорами + спецификация
- **3D модель лестницы** — интерактивная модель на Three.js (вращение мышью, зум колесом)

### Интерактивные курсоры

Все SVG-схемы имеют интерактивный курсор с координатами:
- **План этажа** — X×Y в мм от угла комнаты
- **Вид сверху** — X×Y в мм, X отсчитывается от красной линии (50мм от края проёма)
- **Вид сбоку** — расстояние в мм от красной линии + высота от пола 1-го этажа
- **Развёртка** — примерный номер ступени + высота

## Параметры помещения

| Параметр | Значение |
|----------|----------|
| Размеры этажа (внутренние) | 9.4м × 5.4м |
| Толщина внешних стен | 250 мм |
| Толщина рамы окон | 70 мм |
| Высота потолков | 2.8м |
| Площадь | 50.76 м² |
| Высота между этажами (пол-пол) | 3000 мм |

### Элементы плана

| Элемент | Параметры |
|---------|-----------|
| Внутренняя стена | 3000 мм от левой стены, длина 2630 мм, толщина 250 мм |
| Колонна 1 | 200×150 мм, на расстоянии 2240 мм от внутренней стены |
| Колонна 2 | 200×150 мм, у торца внутренней стены (левый край горизонтальной перегородки) |
| Угловой диван | 3000×2050 мм, глубина 1050 мм, зазор от колонны 100 мм, скруглённые углы, размеры внутри |
| Окно (верхняя стена) | 2540 мм от левой стены, ширина 1250 мм |
| Балконная дверь (правая стена) | 620 мм от нижнего угла, ширина 2270 мм, створка 750 мм (петли на 40 мм от нижнего края) |
| Окно (правая стена, верхнее) | 620 мм от верхнего угла, ширина 1250 мм |
| Окно (левая стена) | 620 мм от нижнего угла, ширина 1250 мм |
| Форточка (левая стена) | 1640 мм от верхнего угла, ширина 910 мм |
| Зона проводки/труб | Внутри помещения у верхней стены, 840–1430 мм правее проёма, высота 100 мм |

### Спальня

Комната справа от двойной вертикальной ГКЛ перегородки.

| Элемент | Параметры |
|---------|-----------|
| Двухспальная кровать | 2000×1600 мм, перпендикулярно верхней стене, 100 мм от верхней стены, 610 мм от правой стены |
| Шкаф | 700×1750 мм, вдоль двойной перегородки, 20 мм от верхней стены |
| Туалетный столик | 1000×450 мм, у верхней стены между шкафом и кроватью, 150 мм от стены |
| Кресло | 820×960 мм, перед туалетным столиком, 250 мм от столика, развёрнуто на 180° |
| ГКЛ перегородка вертикальная (двойная) | 50+75+50 мм (ПН 75 между слоями), от верхней стены до ванной, проём 900 мм (отступ 50 мм от ванной) |
| ГКЛ перегородка горизонтальная (над проёмом) | 50 мм, длина 700 мм, продолжение правой стороны двойной перегородки, отгораживает шкаф от проёма |

### Каркас перегородки спальни

Двойная вертикальная перегородка с раздвижной дверью и горизонтальной частью над проёмом.

| Параметр | Значение |
|----------|----------|
| Общая длина перегородки | 2770 мм (от внешней стены до ванной) |
| Длина до проёма | 1820 мм |
| Толщина перегородки | 175 мм (50+75+50), ПН 75 между слоями |
| Дверной проём | 900×2100 мм |
| Отступ проёма от ванной | 50 мм |
| Горизонтальная часть | 700×50 мм |
| Высота панели ЛДСП | 2700 мм (вплотную к потолку) |
| Высота доборки | 100 мм (снизу, у пола) |

#### Схемы каркаса

- **Внешний слой (со стороны лестницы)** — вид спереди с раскладкой панелей от внешней стены
- **Внутренний слой (со стороны спальни)** — вид сзади, раскладка панелей от короткой перегородки (сдвиг на 50 мм)
- **Разрезы перегородок** — двойная перегородка (ЛДСП только снаружи) и горизонтальная часть (ЛДСП с двух сторон)
- **Горизонтальная часть** — вид со стороны двери в ванную с разрезом двойной перегородки

#### Обшивка ЛДСП

| Элемент | Размер | Кол-во | Примечание |
|---------|--------|--------|------------|
| Панель до проёма | 900×2700×16 мм | 4 шт | 2 панели × 2 стороны (внешний слой) |
| Панель до проёма (внутр.) | 900×2700 + 870×2700×16 мм | 2 шт | Внутренний слой (раскладка от короткой перегородки) |
| Панель над дверью | 900×800×16 мм | 2 шт | До потолка + 100 мм для механизма |
| Панель горизонтальная | 700×2700×16 мм | 2 шт | Обе стороны горизонтальной части |
| Доборка у стены | 20×2700×16 мм | 2 шт | Зазор у внешней стены (внешний слой) |
| Доборка после проёма | 50×2700×16 мм | 2 шт | От проёма до ванной |
| Доборная планка (низ) | ~1800×100×16 мм | 2 шт | Под панелями у пола |

- Панель вплотную к потолку
- Доборные планки снизу заполняют 100 мм до пола
- Панель над дверью заходит на 100 мм в проём для скрытия механизма раздвижной двери
- Внутренний слой: раскладка панелей начинается от короткой перегородки (сдвиг на 50 мм)

#### Каркас (вариант ЛДСП)

| Элемент | Размер | Кол-во | Примечание |
|---------|--------|--------|------------|
| Профиль ПН 50×40 | 2770 мм | 4 шт | Пол + потолок × 2 слоя |
| Профиль ПН 75×40 | 2770 мм | 2 шт | Между слоями (пол + потолок) для зазора 75 мм |
| Профиль ПС 50×50 | 2720 мм | 10 шт | 5 стоек × 2 слоя |
| Брус (над дверью) | 2720×70×50 мм | 2 шт | От стены до конца проёма × 2 слоя |
| Брус (в стойке) | 2720×70×50 мм | 2 шт | Усиление стойки у ванной × 2 слоя |

### Вариант обшивки ГКЛ

Альтернативный вариант перегородки с обшивкой гипсокартоном вместо ЛДСП.

| Параметр | Значение |
|----------|----------|
| Лист ГКЛ | 1200×2500×12.5 мм |
| Шаг стоек | 600 мм |
| Толщина перегородки | 175 мм (50+75+50) + ГКЛ 12.5 мм с каждой стороны |
| Высота проёма | 2000 мм (ГКЛ до низа направляющей) |
| Доборка сверху | 300 мм (до потолка 2800 мм) |

#### Раскладка ГКЛ (внешний слой)

| Элемент | Размер | Кол-во | Примечание |
|---------|--------|--------|------------|
| Лист у стены (обрезной) | 620×2500×12.5 мм | 2 шт | От внешней стены |
| Лист к проёму (полный) | 1200×2500×12.5 мм | 2 шт | С вырезом в верхнем углу |
| Лист над дверью | 975×800×12.5 мм | 2 шт | От середины стойки до ванной, закрывает механизм |
| Доборка сверху | 1795×300×12.5 мм | 2 шт | От стены до середины стойки |
| Полоса у ванной | 50×2000×12.5 мм | 2 шт | После проёма, высота до 2000 мм |

- Листы ГКЛ от пола, доборка сверху
- Швы внутреннего слоя смещены на 600 мм (раскладка вразбежку)
- Горизонтальная направляющая ПН на стыке листа и доборки (2500 мм от пола)
- Горизонтальная направляющая ПН над дверью (2000 мм от пола)

#### Каркас (вариант ГКЛ)

| Элемент | Размер | Кол-во | Примечание |
|---------|--------|--------|------------|
| Профиль ПН 50×40 (пол/потолок) | 2770 мм | 4 шт | Пол + потолок × 2 слоя |
| Профиль ПН 75×40 (между слоями) | 2770 мм | 2 шт | Пол + потолок для зазора 75 мм |
| Профиль ПН 50×40 (над дверью) | 975 мм | 2 шт | Низ на 2000 мм × 2 слоя |
| Профиль ПН 50×40 (стык ГКЛ) | 1795 мм | 2 шт | Центр на 2500 мм × 2 слоя |
| Профиль ПС 50×50 | 2720 мм | 12 шт | 6 стоек × 2 слоя (шаг 600 мм) |
| Брус (над дверью) | 2720×70×50 мм | 2 шт | Для механизма откатной двери × 2 слоя |

**Примечание:** При обшивке ГКЛ 12.5 мм внутри зазора (между слоями) останется 50 мм для механизма откатной двери.

### Ванная комната

Отгорожена ГКЛ перегородками от основного пространства.

| Элемент | Параметры |
|---------|-----------|
| ГКЛ перегородка горизонтальная | Двойная (50+75+50 мм, ПН 75 между слоями), от колонны 2 до колонны 1, два проёма 900 мм (один сразу за колонной 2, второй примыкает к вертикальной перегородке) |
| ГКЛ перегородка вертикальная (ванная) | 100 мм, от колонны до нижней стены |
| Ванна | 1400×700 мм, вдоль правой стены ванной, отступ 50 мм от стен, размеры внутри |
| Унитаз с бачком | 650×380 мм (бачок 200 мм), повёрнут на 90°, у левой стены ванной, бачок 50 мм от стены |
| Зона комфорта унитаза | 250 мм сверху, снизу и спереди от унитаза, пунктирная линия, нижний край вплотную к раковине |
| Угловая тумба с раковиной | 550×550 мм, в нижнем левом углу ванной, отступ 50 мм от стен |
| Окно (нижняя стена) | 630 мм от левой стены ванной, ширина 1250 мм |

## Параметры лестницы

| Параметр | Значение |
|----------|----------|
| Тип | П-образная с двухуровневой площадкой |
| Проём (Д×Ш) | 3000 × 1700 мм |
| Отступ проёма от стены | 50 мм (PLAT_X=0.05) |
| Ширина маршей | 850 мм (MARCH_W = PROEM_H/2) |
| Ширина площадок | 750 мм (PLAT_W=0.75) |

### Ступени

| Параметр | Значение |
|----------|----------|
| Всего подъёмов | 16 |
| Подступёнок (высота) | 187.5 мм |
| Проступь (глубина) | 250 мм |
| Доборная ступень | 200 мм (выход на 2-й этаж) |
| Формула комфорта 2h+b | 625 мм ✓ (норма 600–640) |
| Уклон | 36.9° |

### Структура лестницы

```
Марш 1:  5 ступеней (1250 мм) — подъём снизу вверх, направление от стены
         ↓
Площадка нижняя (подъём 6)
         ↓
Площадка верхняя (подъём 7) — разворот на 180°
         ↓
Марш 2:  8 ступеней (2000 мм) + 1 доборная (200 мм) — подъём к выходу на 2-й этаж
```

**Важно:** Доборная ступень (16-й подъём) = уровень пола 2-го этажа, её край совпадает с краем проёма.

## Константы в коде

Все параметры определены как константы в начале файлов:

```typescript
// Стены и окна
const OWALL_T = 0.25     // Толщина внешних стен (м)
const WIN_FRAME = 0.07   // Толщина рамы окна (м)

// Балконная дверь (правая стена, снизу)
const WIN3_START = 0.62  // Начало от нижнего угла (м)
const WIN3_W = 2.27      // Ширина окна (м)
const DOOR3_HINGE = 0.04 // Петли от нижнего края (м)
const DOOR3_LEN = 0.75   // Длина створки (м)

// Верхнее окно (правая стена, сверху)
const WIN4_START = 0.62  // Начало от верхнего угла (м)
const WIN4_W = 1.25      // Ширина окна (м)

// Окно на левой стене
const WIN5_START = 0.62  // Начало от нижнего угла (м)
const WIN5_W = 1.25      // Ширина окна (м)

// Форточка на левой стене
const WIN6_START = 1.64  // Начало от верхнего угла (м)
const WIN6_W = 0.91      // Ширина форточки (м)

// Колонны
const COL_DIST = 2.24    // Расстояние колонны 1 от внутренней стены (м)
const COL_W = 0.2        // Ширина колонны 1 (м)
const COL_H = 0.15       // Толщина колонны 1 (м)
const COL2_W = 0.2       // Ширина колонны 2 (м)
const COL2_H = 0.15      // Толщина колонны 2 (м)

// ГКЛ перегородки
const GKL_LAYER = 0.05   // Толщина слоя двойной ГКЛ (м)
const GKL_GAP = 0.075    // Зазор между слоями (м) — профиль ПН 75
const GKL4_W = 0.7       // Длина перегородки над проёмом (м)
const GKL4_T = 0.05      // Толщина перегородки над проёмом (м)

// Лестница
const PROEM_W = 3.0      // Ширина проёма (м)
const PROEM_H = 1.7      // Глубина проёма (м)
const PLAT_X = 0.05      // Отступ от стены (м)
const PLAT_W = 0.75      // Ширина площадки (м)
const MARCH_W = 0.85     // Ширина марша (м) = PROEM_H/2
const M1_STEPS = 5       // Ступеней в марше 1
const M2_STEPS = 8       // Ступеней в марше 2
const TREAD = 0.25       // Проступь (м)
const DOBOR_TREAD = 0.20 // Доборная ступень (м)
const TOTAL_RISES = 16   // Всего подъёмов
const RISE_H = 187.5     // Высота подступёнка (мм)
```

## Технический стек

- **React 19** + TypeScript
- **Vite** — сборщик
- **Three.js** — 3D визуализация
- **SVG** — 2D чертежи

## Структура проекта

```
home/
├── CLAUDE.md               # Инструкции для Claude (роль, правила проекта)
├── src/
│   ├── App.tsx              # Главный компонент с навигацией (вкладки)
│   ├── main.tsx             # Точка входа React
│   ├── constants.ts         # Все константы: размеры, стены, окна, мебель, лестница
│   ├── colors.ts            # Цветовая схема проекта
│   ├── svg-primitives.tsx   # SVG-примитивы: размерные линии, ГКЛ панели, окна
│   ├── furniture.tsx        # Библиотека компонентов мебели (диван, кровать, шкаф и т.д.)
│   ├── 2nd-floor-plan.tsx   # План 2-го этажа (SVG, 1000px)
│   ├── partition-frame.tsx      # Каркас перегородки спальни — вариант ЛДСП (SVG)
│   ├── partition-frame-gkl.tsx  # Каркас перегородки спальни — вариант ГКЛ (SVG)
│   ├── stair-detail.tsx     # Детали лестницы: TopView, SideView, SectionView (SVG, 1000px)
│   └── stair-3d.tsx         # 3D модель лестницы (Three.js, 850px)
├── index.html
├── package.json
├── tsconfig.json
├── vite.config.ts
├── .gitignore
└── README.md
```

## Правила разработки

При внесении изменений в проект необходимо переиспользовать существующие модули:

### Цвета (`src/colors.ts`)
- Все цвета должны браться из этого файла
- Если нужного цвета нет — добавить его в соответствующую секцию
- Использовать функцию `rgba(hex, alpha)` для прозрачности

### Константы (`src/constants.ts`)
- Все размеры, отступы и параметры элементов — из этого файла
- Новые константы добавлять в соответствующую секцию с комментарием
- Функция `R()` — для расчёта координат прямоугольников

### SVG-примитивы (`src/svg-primitives.tsx`)
- `HDim` — горизонтальная размерная линия с засечками
- `VDim` — вертикальная размерная линия с засечками
- `GklPanel` — ГКЛ панель с пунктирной рамкой
- `WindowFrame` — оконная рама с разрезом стены
- `DoorwayCross` — крестик проёма (две диагонали)

При добавлении нового примитива — создавать компонент в `svg-primitives.tsx` по аналогии с существующими.

### Мебель (`src/furniture.tsx`)
- `Sofa` — угловой диван L-формы
- `Bed` — двухспальная кровать с подушками
- `Wardrobe` — шкаф
- `Vanity` — туалетный столик с зеркалом
- `Chair` — кресло
- `Bathtub` — ванна
- `SinkCabinet` — угловая тумба с раковиной
- `Toilet` — унитаз с зоной комфорта

При добавлении новой мебели — создавать компонент в `furniture.tsx` по аналогии с существующими.

## Запуск проекта

```bash
# Клонирование репозитория
git clone https://github.com/brutestack/home.git
cd home

# Установка зависимостей и запуск
npm install
npm run dev
```

Откроется на http://localhost:5173 (или следующий свободный порт).

## Оформление размерных линий

Размерные линии имеют засечки на концах — короткие перпендикулярные линии (±2px от основной линии). Засечки нужны, чтобы следующие друг за другом размерные линии визуально не сливались.

```jsx
// Пример размерной линии с засечками (вертикальная линия с горизонтальными засечками)
<line x1={x} y1={y1} x2={x} y2={y2} stroke={C_DIM_TRANS}/>           {/* основная линия */}
<line x1={x-2} y1={y1} x2={x+2} y2={y1} stroke={C_DIM_TRANS}/>       {/* верхняя засечка */}
<line x1={x-2} y1={y2} x2={x+2} y2={y2} stroke={C_DIM_TRANS}/>       {/* нижняя засечка */}
```

## Цветовая схема визуализации

Все цвета определены в `src/colors.ts`:

| Константа | Цвет | Название | Элемент |
|-----------|------|----------|---------|
| C_STEP | #ff9800 | оранжевый | Ступени, проём (пунктир) |
| C_PLATFORM | #ffab40 | светло-оранжевый | Площадки |
| C_EXIT | #4caf50 | зелёный | Доборная ступень, выход на 2-й этаж |
| C_EXIT_FAINT | #4caf5026 | зелёный (прозрачный) | Заливка доборной ступени |
| C_ENTER | #2196f3 | синий | Вход с 1-го этажа |
| C_CRITICAL | #e74c3c | красный | Критические размеры, базовая линия |
| C_DIM | #4fc3f7 | голубой | Размерные линии, окна |
| C_DIM_TRANS | #4fc3f788 | голубой (прозрачный) | Размерные линии (засечки) |
| C_BEDROOM | #6a5acd | фиолетовый | Диван, кровать, надпись "Спальня" |
| C_WARDROBE | #8b4513 | коричневый | Шкаф |
| C_VANITY | #daa520 | золотистый | Туалетный столик, кресло |
| C_COLUMN | #888888 | серый | Колонна |
| C_GKL | #a0a0a0 | светло-серый | ГКЛ перегородки (пунктир) |
| C_PIPES | #e91e63 | розовый | Зона проводки/труб |
| C_BATH | #5dade2 | голубой | Ванная комната |
| C_WALL | #e0e0e0 | белый | Стены |
| C_BG | #1a1a2e | тёмно-синий | Фон страницы |
| C_ROOM | #1e2d4a | синий | Фон комнаты |
| C_TOOLTIP_BG | #000c | чёрный (прозрачный) | Фон подсказок |

Также доступна функция `rgba(hex, alpha)` для создания цвета с произвольной прозрачностью.

## Текущее состояние

- [x] План 2-го этажа с интерактивными координатами
- [x] Вид лестницы сверху с нумерацией ступеней и размерами (проступь, площадки)
- [x] Вид лестницы сбоку с фигурой человека (180см)
- [x] Развёртка лестницы с высотными отметками
- [x] Спецификация лестницы
- [x] 3D модель с вращением и зумом
- [x] Навигация между видами (вкладки)
- [x] Интерактивные курсоры на всех SVG-схемах
- [x] Размерные линии с засечками
- [x] Координата X отсчитывается от красной линии (50мм от края проёма)
- [x] Внутренняя стена с размерными линиями
- [x] Колонна с размерами до всех стен
- [x] Угловой диван (L-форма)
- [x] Все размеры на плане в мм
- [x] Окно на верхней стене
- [x] Зона проводки/труб
- [x] ГКЛ перегородки (двойные с промежутком 50 мм)
- [x] Ванная комната с ванной (1400×700 мм) вдоль правой стены
- [x] Унитаз с бачком (повёрнут на 90°) у левой стены и зоной комфорта (пунктир)
- [x] Угловая тумба с раковиной (550×550 мм) в нижнем левом углу
- [x] Окно на нижней стене ванной (1250 мм)
- [x] Проёмы в перегородках (900 мм, два в горизонтальной перегородке)
- [x] Горизонтальная перегородка над проёмом в спальню (700×50 мм, отгораживает шкаф)
- [x] Угловой диван со скруглёнными углами и размерами внутри
- [x] Обозначение комнаты "Спальня"
- [x] Двухспальная кровать (2000×1600 мм) с подушками
- [x] Шкаф вдоль двойной перегородки (700×1750 мм)
- [x] Туалетный столик (1000×450 мм) с зеркалом
- [x] Кресло (820×960 мм) перед туалетным столиком
- [x] Размерная линия ширины спальни по верхней стене (4980 мм)
- [x] Размерная линия ширины ванной по нижней стене
- [x] Размерная линия ширины спальни по нижней стене
- [x] Размерная линия длины правой стены (5400 мм)
- [x] Внешние стены с толщиной 250 мм (с разрывами для окон)
- [x] Рамы окон толщиной 70 мм у внешнего края стен
- [x] Балконная дверь на правой стене (2270 мм) с открывающейся створкой (750 мм)
- [x] Дуга зоны открытия балконной двери
- [x] Зона проводки/труб внутри помещения (100 мм от верхней стены)
- [x] Верхнее окно на правой стене (1250 мм, 620 мм от верхнего угла)
- [x] Окно на левой стене (1250 мм, 620 мм от нижнего угла)
- [x] Форточка на левой стене (910 мм, 1640 мм от верхнего угла)
- [x] Размерные линии расстояний от окон до углов/перегородок (снаружи помещения)
- [x] Колонна 2 (200×150 мм) вместо левой части горизонтальной ГКЛ перегородки
- [x] Библиотека компонентов мебели (furniture.tsx): Sofa, Bed, Wardrobe, Vanity, Chair, Bathtub, SinkCabinet, Toilet
- [x] Константы вынесены в отдельный файл (constants.ts)
- [x] Цветовая схема вынесена в отдельный файл (colors.ts)
- [x] Схема каркаса перегородки спальни — вариант ЛДСП (внешний слой, внутренний слой, разрезы)
- [x] Схема каркаса перегородки спальни — вариант ГКЛ (шаг стоек 600 мм, раскладка вразбежку)
- [x] Обшивка ЛДСП панелями 900×2700×16 мм (вплотную к потолку, доборка 100 мм снизу)
- [x] Раздвижная дверь с механизмом (панель над дверью 900×800 мм)
- [x] Деревянный брус 50×70 мм для усиления (над дверью и в стойке)
- [x] Спецификация материалов каркаса перегородки
- [x] Размерная линия длины перегородки до проёма (1820 мм) на плане этажа
- [x] Внутренний слой с раскладкой от короткой перегородки (сдвиг 50 мм)
- [x] Горизонтальная часть с разрезом двойной перегородки
