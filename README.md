# Проект планировки дома — 2-й этаж и лестница

## Описание

Интерактивная визуализация планировки второго этажа частного дома и проекта лестницы с первого на второй этаж. Проект включает:

- **План 2-го этажа** — SVG-схема с интерактивными координатами при наведении мыши
- **Детали лестницы** — три вида (сверху, сбоку, разрез/развёртка) с интерактивными курсорами + спецификация
- **3D модель лестницы** — интерактивная модель на Three.js (вращение мышью, зум колесом)

### Интерактивные курсоры

Все SVG-схемы имеют интерактивный курсор с координатами:
- **План этажа** — X×Y в мм от угла комнаты
- **Вид сверху** — X×Y в мм, X отсчитывается от красной линии (50мм от края проёма)
- **Вид сбоку** — расстояние в мм от красной линии + высота от пола 1-го этажа
- **Развёртка** — примерный номер ступени + высота

## Параметры помещения

| Параметр | Значение |
|----------|----------|
| Размеры этажа (внутренние) | 9.4м × 5.4м |
| Толщина внешних стен | 250 мм |
| Толщина рамы окон | 70 мм |
| Высота потолков | 2.8м |
| Площадь | 50.76 м² |
| Высота между этажами (пол-пол) | 3000 мм |

### Элементы плана

| Элемент | Параметры |
|---------|-----------|
| Внутренняя стена | 3000 мм от левой стены, длина 2630 мм, толщина 250 мм |
| Колонна | 200×150 мм, на расстоянии 2240 мм от внутренней стены |
| Угловой диван | 3000×2050 мм, глубина 1050 мм, зазор от колонны 100 мм, скруглённые углы, размеры внутри |
| Окно (верхняя стена) | 2540 мм от левой стены, ширина 1250 мм |
| Балконная дверь (правая стена) | 620 мм от нижнего угла, ширина 2270 мм, створка 750 мм (петли на 40 мм от нижнего края) |
| Окно (правая стена, верхнее) | 620 мм от верхнего угла, ширина 1250 мм |
| Окно (левая стена) | 620 мм от нижнего угла, ширина 1250 мм |
| Форточка (левая стена) | 1640 мм от верхнего угла, ширина 910 мм |
| Зона проводки/труб | Внутри помещения у верхней стены, 840–1430 мм правее проёма, высота 100 мм |

### Спальня

Комната справа от двойной вертикальной ГКЛ перегородки.

| Элемент | Параметры |
|---------|-----------|
| Двухспальная кровать | 2000×1600 мм, перпендикулярно верхней стене, 100 мм от верхней стены, 610 мм от правой стены |
| Шкаф | 600×1770 мм, вдоль двойной перегородки, 20 мм от верхней стены |
| Туалетный столик | 1000×450 мм, у верхней стены между шкафом и кроватью, 150 мм от стены |
| Кресло | 820×960 мм, перед туалетным столиком, 250 мм от столика, развёрнуто на 180° |

### Ванная комната

Отгорожена ГКЛ перегородками от основного пространства.

| Элемент | Параметры |
|---------|-----------|
| ГКЛ перегородка горизонтальная | Двойная (50+50+50 мм), от внутренней стены до колонны, два проёма 900 мм (один с отступом 200 мм от внутренней стены, второй примыкает к вертикальной перегородке) |
| ГКЛ перегородка вертикальная (ванная) | 100 мм, от колонны до нижней стены |
| ГКЛ перегородка вертикальная (двойная) | 50+50+50 мм, от верхней стены до ванной, проём 900 мм (отступ 50 мм от ванной) |
| Ванна | 1400×700 мм, вдоль правой стены ванной, отступ 50 мм от стен, размеры внутри |
| Унитаз с бачком | 650×380 мм (бачок 200 мм), повёрнут на 90°, у левой стены ванной, бачок 50 мм от стены |
| Зона комфорта унитаза | 250 мм сверху, снизу и спереди от унитаза, пунктирная линия, нижний край вплотную к раковине |
| Угловая тумба с раковиной | 550×550 мм, в нижнем левом углу ванной, отступ 50 мм от стен |
| Окно (нижняя стена) | 630 мм от левой стены ванной, ширина 1250 мм |

## Параметры лестницы

| Параметр | Значение |
|----------|----------|
| Тип | П-образная с двухуровневой площадкой |
| Проём (Д×Ш) | 3000 × 1700 мм |
| Отступ проёма от стены | 50 мм (PLAT_X=0.05) |
| Ширина маршей | 850 мм (MARCH_W = PROEM_H/2) |
| Ширина площадок | 750 мм (PLAT_W=0.75) |

### Ступени

| Параметр | Значение |
|----------|----------|
| Всего подъёмов | 16 |
| Подступёнок (высота) | 187.5 мм |
| Проступь (глубина) | 250 мм |
| Доборная ступень | 200 мм (выход на 2-й этаж) |
| Формула комфорта 2h+b | 625 мм ✓ (норма 600–640) |
| Уклон | 36.9° |

### Структура лестницы

```
Марш 1:  5 ступеней (1250 мм) — подъём снизу вверх, направление от стены
         ↓
Площадка нижняя (подъём 6)
         ↓
Площадка верхняя (подъём 7) — разворот на 180°
         ↓
Марш 2:  8 ступеней (2000 мм) + 1 доборная (200 мм) — подъём к выходу на 2-й этаж
```

**Важно:** Доборная ступень (16-й подъём) = уровень пола 2-го этажа, её край совпадает с краем проёма.

## Константы в коде

Все параметры определены как константы в начале файлов:

```typescript
// Стены и окна
const OWALL_T = 0.25     // Толщина внешних стен (м)
const WIN_FRAME = 0.07   // Толщина рамы окна (м)

// Балконная дверь (правая стена, снизу)
const WIN3_START = 0.62  // Начало от нижнего угла (м)
const WIN3_W = 2.27      // Ширина окна (м)
const DOOR3_HINGE = 0.04 // Петли от нижнего края (м)
const DOOR3_LEN = 0.75   // Длина створки (м)

// Верхнее окно (правая стена, сверху)
const WIN4_START = 0.62  // Начало от верхнего угла (м)
const WIN4_W = 1.25      // Ширина окна (м)

// Окно на левой стене
const WIN5_START = 0.62  // Начало от нижнего угла (м)
const WIN5_W = 1.25      // Ширина окна (м)

// Форточка на левой стене
const WIN6_START = 1.64  // Начало от верхнего угла (м)
const WIN6_W = 0.91      // Ширина форточки (м)

// Лестница
const PROEM_W = 3.0      // Ширина проёма (м)
const PROEM_H = 1.7      // Глубина проёма (м)
const PLAT_X = 0.05      // Отступ от стены (м)
const PLAT_W = 0.75      // Ширина площадки (м)
const MARCH_W = 0.85     // Ширина марша (м) = PROEM_H/2
const M1_STEPS = 5       // Ступеней в марше 1
const M2_STEPS = 8       // Ступеней в марше 2
const TREAD = 0.25       // Проступь (м)
const DOBOR_TREAD = 0.20 // Доборная ступень (м)
const TOTAL_RISES = 16   // Всего подъёмов
const RISE_H = 187.5     // Высота подступёнка (мм)
```

## Технический стек

- **React 19** + TypeScript
- **Vite** — сборщик
- **Three.js** — 3D визуализация
- **SVG** — 2D чертежи

## Структура проекта

```
/home/mx16/Work/Home/
├── src/
│   ├── App.tsx              # Главный компонент с навигацией (вкладки)
│   ├── main.tsx             # Точка входа React
│   ├── 2nd-floor-plan.tsx   # План 2-го этажа (SVG, 1000px)
│   ├── stair-detail.tsx     # Детали лестницы: TopView, SideView, SectionView (SVG, 1000px)
│   └── stair-3d.tsx         # 3D модель лестницы (Three.js, 850px)
├── index.html
├── package.json
├── tsconfig.json
├── vite.config.ts
├── .gitignore
└── README.md
```

## Запуск проекта

```bash
cd /home/mx16/Work/Home
npm install
npm run dev
```

Откроется на http://localhost:5173 (или следующий свободный порт).

## Оформление размерных линий

Размерные линии имеют засечки на концах — короткие перпендикулярные линии (±2px от основной линии). Засечки нужны, чтобы следующие друг за другом размерные линии визуально не сливались.

```jsx
// Пример размерной линии с засечками (вертикальная линия с горизонтальными засечками)
<line x1={x} y1={y1} x2={x} y2={y2} stroke="#4fc3f788"/>           {/* основная линия */}
<line x1={x-2} y1={y1} x2={x+2} y2={y1} stroke="#4fc3f788"/>       {/* верхняя засечка */}
<line x1={x-2} y1={y2} x2={x+2} y2={y2} stroke="#4fc3f788"/>       {/* нижняя засечка */}
```

## Цветовая схема визуализации

| Цвет | Элемент |
|------|---------|
| #ff9800 (оранжевый) | Ступени, проём (пунктир) |
| #ffab40 (светло-оранжевый) | Площадки |
| #4caf50 (зелёный) | Доборная ступень, выход на 2-й этаж |
| #2196f3 (синий) | Вход с 1-го этажа |
| #e74c3c (красный) | Критические размеры, линия 2м, базовая линия отсчёта (50мм от края проёма) |
| #4fc3f7 (голубой) | Размерные линии, человек (180см), окно |
| #6a5acd (фиолетовый) | Диван, кровать, надпись "Спальня" |
| #8b4513 (коричневый) | Шкаф |
| #daa520 (золотистый) | Туалетный столик, кресло |
| #888888 (серый) | Колонна, размеры колонны |
| #a0a0a0 (светло-серый) | ГКЛ перегородки (пунктир) |
| #e91e63 (розовый) | Зона проводки/труб |
| #5dade2 (голубой) | Обозначение ванной комнаты |

## Текущее состояние

- [x] План 2-го этажа с интерактивными координатами
- [x] Вид лестницы сверху с нумерацией ступеней и размерами (проступь, площадки)
- [x] Вид лестницы сбоку с фигурой человека (180см)
- [x] Развёртка лестницы с высотными отметками
- [x] Спецификация лестницы
- [x] 3D модель с вращением и зумом
- [x] Навигация между видами (вкладки)
- [x] Интерактивные курсоры на всех SVG-схемах
- [x] Размерные линии с засечками
- [x] Координата X отсчитывается от красной линии (50мм от края проёма)
- [x] Внутренняя стена с размерными линиями
- [x] Колонна с размерами до всех стен
- [x] Угловой диван (L-форма)
- [x] Все размеры на плане в мм
- [x] Окно на верхней стене
- [x] Зона проводки/труб
- [x] ГКЛ перегородки (двойные с промежутком 50 мм)
- [x] Ванная комната с ванной (1400×700 мм) вдоль правой стены
- [x] Унитаз с бачком (повёрнут на 90°) у левой стены и зоной комфорта (пунктир)
- [x] Угловая тумба с раковиной (550×550 мм) в нижнем левом углу
- [x] Окно на нижней стене ванной (1250 мм)
- [x] Проёмы в перегородках (900 мм, два в горизонтальной перегородке)
- [x] Угловой диван со скруглёнными углами и размерами внутри
- [x] Обозначение комнаты "Спальня"
- [x] Двухспальная кровать (2000×1600 мм) с подушками
- [x] Шкаф вдоль двойной перегородки (600×1770 мм)
- [x] Туалетный столик (1000×450 мм) с зеркалом
- [x] Кресло (820×960 мм) перед туалетным столиком
- [x] Размерная линия ширины спальни по верхней стене (4980 мм)
- [x] Размерная линия ширины ванной по нижней стене
- [x] Размерная линия ширины спальни по нижней стене
- [x] Размерная линия длины правой стены (5400 мм)
- [x] Внешние стены с толщиной 250 мм (с разрывами для окон)
- [x] Рамы окон толщиной 70 мм у внешнего края стен
- [x] Балконная дверь на правой стене (2270 мм) с открывающейся створкой (750 мм)
- [x] Дуга зоны открытия балконной двери
- [x] Зона проводки/труб внутри помещения (100 мм от верхней стены)
- [x] Верхнее окно на правой стене (1250 мм, 620 мм от верхнего угла)
- [x] Окно на левой стене (1250 мм, 620 мм от нижнего угла)
- [x] Форточка на левой стене (910 мм, 1640 мм от верхнего угла)
- [x] Размерные линии расстояний от окон до углов/перегородок (снаружи помещения)
